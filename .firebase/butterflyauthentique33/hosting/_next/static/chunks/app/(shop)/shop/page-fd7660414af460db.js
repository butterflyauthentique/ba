(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8069],{1060:(e,t,r)=>{"use strict";r.d(t,{F:()=>i});var a=r(5317),s=r(6104);class i{static async addToWishlist(e,t){try{var r;let i={userId:e,productId:t.id,productName:t.name,productImage:"string"==typeof t.images[0]?t.images[0]:(null==(r=t.images[0])?void 0:r.url)||"",productPrice:t.price,productSlug:t.slug,productCategory:t.category,addedAt:(0,a.serverTimestamp)(),originalPrice:t.price,lastPriceCheck:(0,a.serverTimestamp)(),priority:"medium",isPublic:!1};return(await (0,a.gS)((0,a.rJ)(s.db,this.collection),i)).id}catch(e){throw console.error("Error adding to wishlist:",e),Error("Failed to add item to wishlist")}}static async removeFromWishlist(e,t){try{let r=(0,a.P)((0,a.rJ)(s.db,this.collection),(0,a._M)("userId","==",e),(0,a._M)("productId","==",t)),i=await (0,a.GG)(r);i.empty||await (0,a.deleteDoc)((0,a.H9)(s.db,this.collection,i.docs[0].id))}catch(e){throw console.error("Error removing from wishlist:",e),Error("Failed to remove item from wishlist")}}static async getUserWishlist(e){try{let t=(0,a.P)((0,a.rJ)(s.db,this.collection),(0,a._M)("userId","==",e),(0,a.My)("addedAt","desc"));return(await (0,a.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))}catch(t){if(console.error("Error getting wishlist:",t),t instanceof Error&&t.message&&t.message.includes("index is currently building")){console.log("⚠️ Index still building, using fallback query...");try{let t=(0,a.P)((0,a.rJ)(s.db,this.collection),(0,a._M)("userId","==",e)),r=(await (0,a.GG)(t)).docs.map(e=>({id:e.id,...e.data()}));return r.sort((e,t)=>{var r,a,s,i;let l=(null==(a=e.addedAt)||null==(r=a.toDate)?void 0:r.call(a))||new Date(0);return((null==(i=t.addedAt)||null==(s=i.toDate)?void 0:s.call(i))||new Date(0)).getTime()-l.getTime()}),console.log("✅ Found ".concat(r.length," wishlist items (fallback query)")),r}catch(e){console.error("Fallback query also failed:",e)}}throw Error("Failed to get wishlist")}}static async isInWishlist(e,t){try{let r=(0,a.P)((0,a.rJ)(s.db,this.collection),(0,a._M)("userId","==",e),(0,a._M)("productId","==",t));return!(await (0,a.GG)(r)).empty}catch(e){return console.error("Error checking wishlist status:",e),e instanceof Error&&e.message&&e.message.includes("index is currently building")&&console.log("⚠️ Index still building, returning false for wishlist status"),!1}}static async updateWishlistItem(e,t){try{let r=(0,a.H9)(s.db,this.collection,e);await (0,a.mZ)(r,{...t,lastPriceCheck:(0,a.serverTimestamp)()})}catch(e){throw console.error("Error updating wishlist item:",e),Error("Failed to update wishlist item")}}static async getWishlistCount(e){try{let t=(0,a.P)((0,a.rJ)(s.db,this.collection),(0,a._M)("userId","==",e));return(await (0,a.GG)(t)).size}catch(e){return console.error("Error getting wishlist count:",e),e instanceof Error&&e.message&&e.message.includes("index is currently building")&&console.log("⚠️ Index still building, returning 0 for wishlist count"),0}}static async toggleWishlistItem(e,t){try{if(await this.isInWishlist(e,t.id))return await this.removeFromWishlist(e,t.id),{added:!1};{let r=await this.addToWishlist(e,t);return{added:!0,itemId:r}}}catch(e){throw console.error("Error toggling wishlist item:",e),Error("Failed to toggle wishlist item")}}}i.collection="wishlist"},2730:(e,t,r)=>{"use strict";r.d(t,{C:()=>l,e:()=>o});var a=r(5453),s=r(6786),i=r(2115);let l=(0,a.v)()((0,s.Zr)((e,t)=>({cart:[],addToCart:t=>{e(e=>{let r=Array.isArray(e.cart)?e.cart:[];return r.find(e=>e.productId===t.productId&&e.variantId===t.variantId)?{cart:r.map(e=>e.productId===t.productId&&e.variantId===t.variantId?{...e,quantity:e.quantity+t.quantity}:e)}:{cart:[...r,t]}})},removeFromCart:(t,r)=>{e(e=>({cart:(Array.isArray(e.cart)?e.cart:[]).filter(e=>e.productId!==t||e.variantId!==r)}))},updateCartQuantity:(t,r,a)=>{e(e=>({cart:(Array.isArray(e.cart)?e.cart:[]).map(e=>e.productId===t&&e.variantId===a?{...e,quantity:r}:e).filter(e=>e.quantity>0)}))},clearCart:()=>e({cart:[]}),isLoading:!1,setLoading:t=>e({isLoading:t}),theme:"light",setTheme:t=>e({theme:t}),checkoutForm:{email:"",name:"",phone:"",address:"",city:"",state:"",zipCode:""},updateCheckoutForm:t=>{e(e=>({checkoutForm:{...e.checkoutForm,...t}}))},getCartTotal:()=>{let{cart:e}=t();return(Array.isArray(e)?e:[]).reduce((e,t)=>e+t.price*t.quantity,0)},getCartItemCount:()=>{let{cart:e}=t();return(Array.isArray(e)?e:[]).reduce((e,t)=>e+t.quantity,0)}}),{name:"butterfly-authentique-store",partialize:e=>({cart:e.cart,theme:e.theme,checkoutForm:e.checkoutForm})})),o=()=>{let e=l(),[t,r]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{r(!0)},[]),t?e:{cart:[],addToCart:()=>{},removeFromCart:()=>{},updateCartQuantity:()=>{},clearCart:()=>{},isLoading:!1,setLoading:()=>{},theme:"light",setTheme:()=>{},checkoutForm:{email:"",name:"",phone:"",address:"",city:"",state:"",zipCode:""},updateCheckoutForm:()=>{},getCartTotal:()=>0,getCartItemCount:()=>0}}},4396:(e,t,r)=>{"use strict";r.d(t,{default:()=>v});var a=r(5155),s=r(2115),i=r(6874),l=r.n(i),o=r(6766),c=r(7924),n=r(6151),d=r(1976),u=r(8564),g=r(2730),m=r(1060),h=r(3999),p=r(3568),y=r(5317),x=r(6104);class f{static async getProducts(){try{console.log("\uD83D\uDD0D [Client] Getting all active products...");try{let e=(0,y.P)((0,y.rJ)(x.db,"products"),(0,y._M)("status","==","active"),(0,y.My)("createdAt","desc")),t=await (0,y.GG)(e);return console.log("✅ [Client] Found ".concat(t.docs.length," active products (with index)")),t.docs.map(e=>({id:e.id,...e.data()}))}catch(r){console.log("⚠️ [Client] Index not ready, using fallback query...");let e=(0,y.P)((0,y.rJ)(x.db,"products")),t=(await (0,y.GG)(e)).docs.map(e=>({id:e.id,...e.data()})).filter(e=>"active"===e.status).sort((e,t)=>{var r,a,s,i;let l=(null==(a=e.createdAt)||null==(r=a.toDate)?void 0:r.call(a))||new Date(0);return((null==(i=t.createdAt)||null==(s=i.toDate)?void 0:s.call(i))||new Date(0)).getTime()-l.getTime()});return console.log("✅ [Client] Found ".concat(t.length," active products (fallback)")),t}}catch(e){return console.error("❌ [Client] Error getting products:",e),[]}}static async getProduct(e){try{console.log("\uD83D\uDD0D [Client] Getting product by ID or slug:",e);let t=(0,y.H9)(x.db,"products",e),r=await (0,y.x7)(t);if(r.exists()){let e=r.data();if("active"===e.status)return console.log("✅ [Client] Product found by ID"),{id:r.id,...e}}console.log("\uD83D\uDD0D [Client] Product not found by ID, searching by slug...");let a=(0,y.P)((0,y.rJ)(x.db,"products"),(0,y._M)("slug","==",e),(0,y._M)("status","==","active"),(0,y.AB)(1)),s=await (0,y.GG)(a);if(!s.empty){let e=s.docs[0];return console.log("✅ [Client] Product found by slug"),{id:e.id,...e.data()}}return console.log("❌ [Client] Product not found by ID or slug"),null}catch(e){return console.error("❌ [Client] Error getting product:",e),null}}static async getProductsByCategory(e){try{console.log("\uD83D\uDD0D [Client] Getting products by category:",e);try{let t=(0,y.P)((0,y.rJ)(x.db,"products"),(0,y._M)("status","==","active"),(0,y._M)("category","==",e),(0,y.My)("createdAt","desc")),r=await (0,y.GG)(t);return console.log("✅ [Client] Found ".concat(r.docs.length," products in category ").concat(e," (with index)")),r.docs.map(e=>({id:e.id,...e.data()}))}catch(a){console.log("⚠️ [Client] Index not ready, using fallback query for category...");let t=(0,y.P)((0,y.rJ)(x.db,"products")),r=(await (0,y.GG)(t)).docs.map(e=>({id:e.id,...e.data()})).filter(t=>"active"===t.status&&t.category===e).sort((e,t)=>{var r,a,s,i;let l=(null==(a=e.createdAt)||null==(r=a.toDate)?void 0:r.call(a))||new Date(0);return((null==(i=t.createdAt)||null==(s=i.toDate)?void 0:s.call(i))||new Date(0)).getTime()-l.getTime()});return console.log("✅ [Client] Found ".concat(r.length," products in category ").concat(e," (fallback)")),r}}catch(e){return console.error("❌ [Client] Error getting products by category:",e),[]}}}function v(e){let{products:t}=e,{addToCart:r}=(0,g.e)(),{user:i}=(0,h.A)(),[y,x]=(0,s.useState)(t),[v,w]=(0,s.useState)(!1),[b,C]=(0,s.useState)(""),[j,N]=(0,s.useState)("all"),[I,A]=(0,s.useState)("name"),[E,P]=(0,s.useState)(new Set);(0,s.useEffect)(()=>{(async()=>{try{if(w(!0),"all"===j){let e=await f.getProducts();x(e)}else{let e=await f.getProductsByCategory(j);x(e)}}catch(e){console.error("Error fetching products by category:",e),p.Ay.error("Failed to load products")}finally{w(!1)}})()},[j]);let F=[...y.filter(e=>{var t,r;return e.name.toLowerCase().includes(b.toLowerCase())||(null==(t=e.description)?void 0:t.toLowerCase().includes(b.toLowerCase()))||(null==(r=e.artist)?void 0:r.toLowerCase().includes(b.toLowerCase()))})].sort((e,t)=>"name"===I?e.name.localeCompare(t.name):"price"===I?e.price-t.price:"rating"===I?(t.rating||0)-(e.rating||0):0),k=e=>{var t;r({productId:e.id,quantity:1,price:e.price,name:e.name,image:(null==(t=e.images[0])?void 0:t.url)||""}),p.Ay.success("".concat(e.name," added to cart"))};(0,s.useEffect)(()=>{(async()=>{if(i)try{let e=await m.F.getUserWishlist(i.id),t=new Set(e.map(e=>e.productId));P(t)}catch(e){console.error("Error loading wishlist items:",e)}})()},[i]);let _=async e=>{if(!i)return void p.Ay.error("Please log in to add items to wishlist");try{(await m.F.toggleWishlistItem(i.id,e)).added?(P(t=>new Set([...t,e.id])),p.Ay.success("Added to wishlist")):(P(t=>{let r=new Set(t);return r.delete(e.id),r}),p.Ay.success("Removed from wishlist"))}catch(e){console.error("Error toggling wishlist:",e),p.Ay.error("Failed to update wishlist")}},G=["all",...Array.from(new Set(t.map(e=>e.category)))];return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("section",{className:"bg-gradient-to-r from-red-600 to-red-700 text-white py-16",children:(0,a.jsx)("div",{className:"container",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Our Collection"}),(0,a.jsx)("p",{className:"text-xl text-white/90 max-w-2xl mx-auto",children:"Discover unique handcrafted jewelry, stunning paintings, and elegant stoles. Each piece tells a story of artistic excellence and cultural heritage."})]})})}),(0,a.jsx)("section",{className:"py-8 bg-white border-b",children:(0,a.jsx)("div",{className:"container",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6 items-center justify-between",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(c.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:"text",placeholder:"Search products...",value:b,onChange:e=>C(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Category:"}),(0,a.jsx)("select",{value:j,onChange:e=>N(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:G.map(e=>(0,a.jsx)("option",{value:e,children:"all"===e?"All Categories":e},e))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Sort by:"}),(0,a.jsxs)("select",{value:I,onChange:e=>A(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"name",children:"Name"}),(0,a.jsx)("option",{value:"price",children:"Price"}),(0,a.jsx)("option",{value:"rating",children:"Rating"})]})]})]})})}),(0,a.jsx)("section",{className:"py-12",children:(0,a.jsx)("div",{className:"container",children:v?(0,a.jsx)("div",{className:"text-center py-16",children:(0,a.jsx)("p",{children:"Loading products..."})}):F.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:F.map(e=>{var t;return(0,a.jsxs)(l(),{href:"/product/".concat(e.slug||e.id),className:"product-card group",children:[(0,a.jsxs)("div",{className:"relative aspect-square bg-gray-100 overflow-hidden rounded-t-xl",children:[e.images&&e.images.length>0?(0,a.jsx)(o.default,{src:"string"==typeof e.images[0]?e.images[0]:(null==(t=e.images[0])?void 0:t.url)||"",alt:e.name,fill:!0,className:"object-cover transition-transform duration-300 group-hover:scale-105",sizes:"(max-width: 640px) 100vw, (max-width: 768px) 50vw, (max-width: 1024px) 33vw, 25vw",priority:!1,onError:t=>{let r=t.target,a=e.images[0];if(("string"==typeof a?a:null==a?void 0:a.url)&&e.images.length>1){let t=(e.images.findIndex(e=>("string"==typeof e?e:(null==e?void 0:e.url)||"")===r.src)+1)%e.images.length,a=e.images[t];r.src="string"==typeof a?a:(null==a?void 0:a.url)||""}else{var s;r.style.display="none";let e=null==(s=r.parentElement)?void 0:s.querySelector(".image-placeholder");e&&(e.style.display="flex")}}}):null,(!e.images||0===e.images.length)&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-200",children:(0,a.jsx)(n.A,{className:"w-12 h-12 text-gray-400"})}),(0,a.jsx)("div",{className:"image-placeholder absolute inset-0 hidden items-center justify-center bg-gray-200",children:(0,a.jsx)(n.A,{className:"w-12 h-12 text-gray-400"})}),(0,a.jsx)("button",{onClick:t=>{t.preventDefault(),_(e)},className:"absolute top-3 right-3 w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-md opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-50",children:(0,a.jsx)(d.A,{className:"w-4 h-4 ".concat(E.has(e.id)?"text-red-600 fill-current":"text-gray-600")})}),(0,a.jsx)("button",{onClick:t=>{t.preventDefault(),k(e)},className:"absolute bottom-3 left-1/2 transform -translate-x-1/2 bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-700",children:"Quick Add"})]}),(0,a.jsxs)("div",{className:"product-card__content",children:[(0,a.jsx)("div",{className:"text-xs font-medium text-red-600 uppercase tracking-wider mb-2",children:e.category}),(0,a.jsx)("h3",{className:"product-card__title line-clamp-2",children:e.name}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center gap-1 mb-3",children:[(0,a.jsx)(u.A,{className:"w-4 h-4 text-yellow-400 fill-current"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.rating||0}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["(",e.reviews||0,")"]})]}),(0,a.jsxs)("div",{className:"product-card__price",children:["₹",e.price.toLocaleString()]}),(0,a.jsx)("div",{className:"product-card__actions",children:(0,a.jsx)("button",{onClick:t=>{t.preventDefault(),k(e)},className:"btn-primary text-sm px-4 py-2 flex-1",children:"Add to Cart"})})]})]},e.id)})}):(0,a.jsx)("div",{className:"text-center py-16",children:(0,a.jsx)("p",{className:"text-gray-500",children:"No products found."})})})})]})}f.getProduct,f.getProducts},4605:(e,t,r)=>{Promise.resolve().then(r.bind(r,4396))}},e=>{e.O(0,[9135,3965,6874,3568,4787,3063,8626,3999,8441,5964,7358],()=>e(e.s=4605)),_N_E=e.O()}]);